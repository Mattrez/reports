\documentclass{article}
\title{Referat - Systemy operacyjne i administracja}
\author{Mateusz Radomski \and Michał Posłuszny}
\date{gr lab. 8, IT Rok I \\ Numery indeksów: 400569, 401341 }

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[MeX]{polski}

\begin{document}
\maketitle

\section{Temat - 1}
\subsection{\textit{creat()}}
Wywołanie tej funkcji jest ekwiwalente do wywołania funkcji \textbf{open()} z flagami O\_CREAT, O\_WRONLY, O\_TRUNC. Otwiera ona plik w trybie zapisu, oraz tworzy nowy plik lub już istniejący przycina do zera. Zwraca deskryptor pliku, który jest liczbą całkowitą 32 bitową, w języku C jest to typ odpowiadający \textit{int}.

Flaga O\_CREAT tworzy zwykły plik na podanej ścieżce dostępu jeżeli nie istniała ona w chwili wywołania funkcji. Efektem tego jest plik, którego właścicielem jest użytkownik, który stworzył proces wywołujący tę funkcję.

O\_WRONLY oznacza otworzenie pliku tylko w trybie zapisu.

O\_TRUNC informuje funkcję, że jeżeli plik na podanej ścieżce dostępu już istnieje i jest zwykłym plikiem oraz użytkownik ma do niego dostęp, to jest on przycięty do zera.

Funkcja do poprawnego wywołania przyjmuje dwa argumenty ścieżke do otworzenia oraz permisje jakie mają zostać nadane nowo stworzonemu plikowi.

Ścieżka dostępu jest stałym łańcuchem znaków, który jest interpretowany tak jak w środowisku Unix.
Ścieżka zaczynająca się od `/' jest interpretowana jako absolutna, natomiast inne jako relatywne do
ścieżki, w której obecnie znajduje się proces.

Permisje są używane gdy plik w czasie wywołania funkcji nie istniał i zostaje on stworzony.
Przesłane permisje są mu wtedy nadane, permisja taka jest storzona poprzez logiczny operator
\textit{or} w języku C oznaczany symbolem `|'. Należy połączyć dostarczone przez system stałe,
w taki sposób aby nowy plik uzyskał żądane permisje.

Funckja zwraca deskryptor pliku, lub wartość równą $-1$ gdy wystąpił błąd.
W takim przypadku, zmienna globalna \textit{errno} jest ustawiona na wartością opisującą błąd.
\begin{itemize}
\item \textbf{EACCES} - do podanej ścieżki nie mamy dostępu. Zawiera to w sobie również,
iż ścieżka przez, która należałoby przejść aby dostać się do pliku nie zezwala na to.
Również sam plik może nie zezwalać nam na jego otworzenie lub modyfikację.
\item \textbf{EDQUOT} - brak miejsca na dysku dla wywołującego użytkownika.
\item \textbf{EINTR} - sygnał przerwał wykonywanie funkcji.
\item \textbf{EISDIR} - wskazana ścieżka jest już folderem.
\item \textbf{ELOOP} - Podczas przechodzenia przez ścieżkę zbyt wiele linków symbolicznych zostało napotkanych.
\item \textbf{EMFILE} - Proces, ma otworzonych zbyt wiele plików.
\item \textbf{ENOENT} - Cześć ścieżki dostępu nie istnieje lub ścieżka dostępu jest pusta.
\end{itemize}

Nie istnieją duże różnice pomiędzy tą funkcją na jądrze Linux a na jądrze znajdującym się na systemie Solarisie.
Funkcje odpowiadają temu samemu wywołaniu funkcji \textbf{open()} oraz zachowują się tak samo.

\subsection{\textit{open()}}
Jest wiele efektów wywołania tej funkcji zależnie od podanych jej argumentów.
Lecz jej głównym zadaniem jest otworzenie jakiegoś pliku i zwrócenie do niego deskryptora.

Do funkcji przesyłana jest ścieżka dostępu, ewentualne flagi zmieniające jej działanie oraz możliwe jest przesłanie jej permisji pliku.
Po wywołaniu zwraca wartość taką jak w przypadku funkcji \textbf{creat()}.

Argument ścieżki oraz permisji pliku są identyczne jak w wyżej opisanej funkcji \textbf{creat()}.

Flagi przesłane do funkcji zmieniają wiele rzeczy, najprostsze z nich otwierają plik w innych trybach odczytu/zapisu.
O\_RDONLY, O\_WRONLY, O\_RDWR i O\_APPEND odpowiadają następująco otworzenie w trybie tylko odczytu, tylko zapisu, odczyt i zapis oraz tryb dodawania do pliku zamiast przyciana go do zera.

\begin{itemize}
\item \textbf{O\_CREAT} - opisane w przykładzie funkcji \textbf{creat()}
\item \textbf{O\_LARGEFILE} - zezwala na używanie przesunięcia w pliku większego niż $2^{32}$
\item \textbf{O\_NONBLOCK} - otwiera plik bez blokowania programu i czekania aż plik się otworzy. Zwracany jest deskryptor pliku lecz nie jest od odrazu gotowy do użycia
\item \textbf{O\_SYNC} - podczas zapisu do pliku proces jest blokowany do momentu dostarczenia danych do zapisywanego sprzętu
\item \textbf{O\_TRUNC} - opisane w przykładzie funkcji \textbf{creat()}
\end{itemize}

Funckja zwraca deskryptor pliku, lub wartość równą $-1$ gdy wystąpił błąd.
W takim przypadku, zmienna globalna \textit{errno} jest ustawiona na wartością opisującą błąd.
Wszystkie błędy są identyczne jak w przyadku funckji \textbf{creat()}.

Funkcja ta na Linux'ie posiada więcej flag jakie można ustawić, jako przykałdy można wymienić: \textbf{O\_ASYNC}, \textbf{O\_DIRECTORY}.
Ponieważ jest więcej flag, które można ustawić, istnieje również więcej błędów jakie na jakie może napotkać funkcja. 

\subsection{\textit{read()}}
Funkcja ta będzie odczytywać $n$ bajtów z przesłanego deskryptora pliku do miejsca w pamięci,
które jest buforem wskazanym przez użytkownika.

Funkcja zostaje wywołana z określonym deskryptorem, adresem, które jest buforem oraz ilością $n$ bajtów, które mają zostać wczytane. Funkcja zwraca wartość typu \textit{ssize\_t}, która określa ilość wczytanych bajtów lub informuje o błędzie.

Deskryptor plików monżna otrzymać poprzez użycie funkcji \textbf{open()} lub \textbf{creat()}.
Bufor, do którego dane będą wczytywane użytkownik musi stworzyć odpowiednio duży, ponieważ funkcja nie sprawdza czy ma możliwość zapisywania do danego miejsca w pamięci.
$n$ bajtów, które zostaną wczytane są liczbą całkowitą typu \textit{size\_t}.
Oznacza to, że maksymalna ilość bajtów jaka może zostać wczytana jest ograniczona przez architekturę bitową systemu operacyjnego, na którym skompilowany został program.

Funckja zwraca ilość wczytanych bajtów, lub wartość równą $-1$ gdy wystąpił błąd.
W takim przypadku, zmienna globalna \textit{errno} jest ustawiona na wartością opisującą błąd.

\begin{itemize}
\item \textbf{EBADF} - z przesłanego deskryptora pliku nie można odczytywać.
\item \textbf{EFAULT} - wskaźnik bufora wskazuje na nielegalne miejsce.
\item \textbf{EINTR} - sygnał przerwał wczytywanie danych przez funkcję.
\item \textbf{EIO} - wystąpił błąd fizyczny z urządzeniem wejścia/wyjścia.
\item \textbf{EISDIR} - przesłany deskryptor jest folderem.
\item \textbf{ENOLINK} - przesłany deskryptor jest linkiem do nieaktywnej maszyny zewnętrznej.
\item \textbf{ESPIPE} - przesłany deskryptor jest powiązany z \textit{pipe}'em.
\end{itemize}

Istnieje różnica pomiędzy wersją tej tej funkcji na systemie Solaris a systemie Linux.
W przypadku wywołania jej z argumentem deskryptora pliku będącego \textit{socket'em} wywołanie to jest równoważne z wywołaniem funkcji \textbf{recv()} bez flag.

  
\section{Temat - 3}
\subsection{\textit{link()}}
Wywołując komendę link tworzymy nowe dowiązanie (zwane też twardym, ang. hard link) najczęściej w innej lokalizacji. Nasza nowa nazwa pliku może być używana dokładnie tak samo jak stara w dowolnych operacjach, ponieważ obie nazwy odnoszą się do tego samego pliku, więc ich właściciel jak i prawa pozostają identyczne, przez co niemożliwe jest wskazania oryginału.

Funkcja jest wywoływana z określonym położeniem pliku i położeniem naszego dowiązania. Po wykonaniu zwraca wartość zero, w przypadku błędu zwraca -1 i ustawia zmienną globalną \textit{errno} na wartość opisującą odpowiedni błąd.


\textbf{Argumentami} tej funkcji są kolejno:
\begin{itemize}
\item \textbf{oldpath} - ścieżka do naszego pliku
\item \textbf{newpath} - ścieżka w której chcemy utworzyc dowiązanie (w momencie w którym w ścieżce newpath plik już istnieje, dowiązanie nie zostanie utworzone a plik nie zostanie nadpisany)
\end{itemize}

\textbf{Opis błędów}
\begin{itemize}
\item \textbf{EACCES} zapis do lokalizacji w której jest \textit{newpath} nie jest dozwolony, bądź \textit{oldpath} lub \textit{newpath} nie daje uprawnień wykonywania (przeszukiwania katalogu).
\item \textbf{EDQUOT} wyczerpano limit bloków dysku użytkownika w tym systemie plików.
\item \textbf{EEXIST} plik \textit{newpath} już istnieje
\item \textbf{EFAULT} \textit{oldpath} lub \textit{newpath} wskazuje na przestrzeń adresową niedostępną dla użytkownika.
\item \textbf{EIO} Wystąpił błąd fizyczny z urządzeniem Wejścia/Wyjścia
\item \textbf{ELOOP} Podczas przetwarzania \textit{oldpath} lub \textit{newpath} napotkano zbyt dużo dowiązań symbolicznych
\item \textbf{EMLINK} Plik do którego odnosi się \textit{oldpath} posiada już maksymalną ilość dowiązań. W systemie \textit{ext4} maksymalna liczba twardych dowiązań to 65,000 
\item \textbf{ENAMETOOLONG} Długość któregoś z argumentów 
przekracza wartość w zmiennej globalnej PATH\_MAX
\item \textbf{ENOENT}  \textit{oldpath} lub \textit{newpath} jest pustą ścieżką, taka ścieżka nie istnieje lub plik  \textit{oldpath} nie istnieje
\item \textbf{ENOLINK}  \textit{oldpath} lub \textit{newpath} wskazuje na zdalną maszynę lub dowiązanie do tej maszyny nie jest już aktywne
\item \textbf{ENOSPC}  Ścieżka w której miało znajdować się dowiązanie nie może być rozszerzone.
\item \textbf{ENOTDIR}  Komponent użyty w jednej z podanych ścieżek nie jest katalogiem.
\item \textbf{EPERM} system plików w których znajdują się \textit{oldpath} i \textit{newpath} nie obsługuje tworzenia dowiązań.
\item \textbf{EROFS} zarządane dowiązanie wymaga zapisu w ścieżce w systemie plików tylko do odczytu.

\item \textbf{EXDEV} \textit{oldpath} i \textit{newpath} leżą w innych systemach plików.


\end{itemize}
\textbf{Różnice między Linuxem a Solarise}
Nazwy argumentów na Solarisie są inne:
\textit{newpath} nazywa się \textit{new},
\textit{oldpath} nazywa się \textit{existing}
Zamiast błęduo \textbf{EIO} w Solarisie możemy napotkać błąd
\textbf{EINTR} Napotkano sygnał podczas wykonywania funkcji link.


\subsection{\textit{symlink()}}

Funkcja symlink tworzy dowiązanie symboliczne (miękkie dowiązanie), o nazwie \textit{linkpath} który zawiera łańcuch znaków pliku \textit{target}. Dowiązania symboliczne mogą zawierać składniki .., które w przypadku użycia na początku dowiązania odnoszą się do katalogów nadrzędnych ścieżki w której utworzono dowiązanie.

Istnieje przypadek w którym dowiązanie symboliczne może wskazywać na nieistniejący plik, jest to tak zwane wiszące dowiązanie.

Prawa dostęp do dowiązania symbolicznego są nieistotne, ignoruje się jego właściciela w trakcie podążania za powiązaniem. Jednakże są one sprawdzane podczas usuwania bądź modyfikacji nazwy dowiązania gdy dowiązanie symboliczne znajduje się w katalogu z ustawionym bitem \textit{sticky} ( \textbf{S-ISVTX} ).

Podczas wywołania podaj się tak jak w przypadku funkcji link() ścieżkę do pliku i ścieżkę w której ma zostać utworzone dowiązanie.
Funkcja zwraca wartość zero gdy się powiedzie, w wypadku błędu zwraca wartość -1 i ustawia zmienną globalną \textit{errno} na wartość opisującą odpowiedni błąd.

\textbf{Argumentami} tej funkcji są kolejno:
\begin{itemize}
\item \textbf{target} - ścieżka do naszego pliku
\item \textbf{linkpath} - ścieżka w której chcemy utworzyc dowiązanie (w momencie w którym w ścieżce newpath plik już istnieje, dowiązanie nie zostanie utworzone a plik nie zostanie nadpisany)
\end{itemize}

\textbf{Opis błędów}
\begin{itemize}
\item \textbf{EACCES} zapis do lokalizacji w której jest \textit{linkpath} nie jest dozwolony, bądź jeden z katalogów w ścieżce \textit{linkpath} nie daje uprawnień wykonywania (przeszukiwania katalogu).
\item \textbf{EDQUOT} wyczerpano limit bloków dysku użytkownika w tym systemie plików.
\item \textbf{EEXIST} plik \textit{linkpath} już istnieje
\item \textbf{EFAULT} \textit{target} lub  \textit{linkpath} wskazuje na przestrzeń adresową niedostępną dla użytkownika.
\item \textbf{EIO} Wystąpił błąd fizyczny z urządzeniem Wejścia/Wyjścia
\item \textbf{ELOOP} Podczas przetwarzania \textit{linkpath} lub napotkano zbyt dużo dowiązań symbolicznych
\item \textbf{ENAMETOOLONG} Długość któregoś z argumentów 
przekracza wartość w zmiennej globalnej PATH\_MAX
\item \textbf{ENOENT}  \textit{target} lub \textit{linkpath} jest pustą ścieżką, taka ścieżka nie istnieje lub \textit{linkpath} jest wiszącym dowiązaniem symbolicznym. 

\item \textbf{ENOMEM}  Wymagana ilość pamięci jądra nie była dostępna.
\item \textbf{ENOSPC}  Ścieżka w której miało znajdować się dowiązanie nie może być rozszerzone.
\item \textbf{ENOTDIR}  Komponent użyty w jednej z podanych ścieżek nie jest katalogiem.
\item \textbf{EPERM} system plików w których znajduje się \textit{linkpath} nie obsługuje tworzenia symbolicznych dowiązań.
\item \textbf{EROFS} zarządane dowiązanie wymaga zapisu w ścieżce w systemie plików tylko do odczytu.



\end{itemize}
\textbf{Różnice między Linuxem a Solarise}


Nazwy argumentów na Solarisie są inne:

\textit{linkpath} nazywa się \textit{name1},

\textit{target} nazywa się \textit{name2}

W Solarisie  błąd \textbf{EPERM} nazywa się \textbf{ENOSYS}
Solaris nie posiada błędu informującego o niewystarczającej pamięci jądra \textbf{ENOMEM}


\subsection{\textit{stat()}}

\end{document}
